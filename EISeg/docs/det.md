
# 图片检测标注
<div align="center">
<p align="center">
  <img src="https://user-images.githubusercontent.com/35907364/203894000-4ab86c85-e7e5-48f6-b2c4-bf8804ef6a08.gif" align="middle" alt="LOGO" width = "800" />
</p>
</div>

以下内容为2D图片检测预标注模型下载及EISeg2D图片检测标注流程，具体如下：

## 模型准备

在使用EISeg进行检测标注前，如果使用预标注功能，请先下载检测预标注模型参数。EISeg开放了在xxx数据集上训练的检测模型，满足通用场景检测预标注需求。用户可以根据自己的需要选择是否启用预标注功能来进行预标注模型的加载和使用。


| 模型类型  | 适用场景                   | 模型结构       | 模型下载地址                                                     |
|-------| -------------------------- | -------------- | ------------------------------------------------------------ |
| 轻量化模型 | 通用场景的图像标注       |  PicoDet-S           | [PicoDet-S ](https://paddledet.bj.bcebos.com/deploy/Inference/picodet_s_416_coco_lcnet.tar) |

**NOTE**： 将下载的模型结构`*.pdmodel`及相应的模型参数`*.pdiparams`需要放到同一个目录下，在检测标注模式中，如果启用预标注功能，则加载模型时只需选择`*.pdiparams`结尾的模型参数位置即可， `*.pdmodel`会自动加载。如果选择不启用预标注，则无需加载模型。


## 使用步骤
EISeg的检测标注功能的使用整体流程如下图所示，具体可见下方使用步骤说明：

<p align="center">
<img src="https://user-images.githubusercontent.com/48357642/202401769-49f3de96-41b8-406b-ae1c-b6edf163a5c4.png" width="100%" height="100%">
<p align="center">
 整体使用流程
</p>
</p>


打开软件后，在对项目进行标注前，需要进行如下设置：

0. **标注模式选择**

   点击软件右上角的模式切换按钮，进入检测标注模式中，并根据弹窗提示选择是否启用检测预标注功能，若不启用，则跳过下方的步骤1和步骤2。

1. **模型参数加载**

   在`模型选择`区域中点击`加载网络参数`按钮，选择合适的模型及参数下载解压后，模型结构`*.pdmodel`及相应的模型参数`*.pdiparams`需要放到同一个目录下，加载模型时只需选择`*.pdiparams`结尾的模型参数位置即可。正确加载的模型参数会记录在`近期模型参数`中，可以方便切换，并且下次打开软件时自动加载退出时的模型参数。

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202402532-ef022aaa-eb43-4b1d-a2f8-7f4b0380bd5f.png" width="40%" height="20%">
   </p>

2. **预标注设置**

   在`检测设置`区域中点击`预标注设置`按钮，即可在弹出的界面中设置预标注模型标签和自定义标签之间的对应关系，以及是否启用某一类别的标签，此外，也可在该界面的搜索框中查找特定标签，便于用户快速选择目标标签建立标签对应关系，默认情况下，会启用COCO 80类的标签为预标注模型标签。完成建立标签对应关系之后，图像预标注的结果中只会显示用户启用的标签对以及自定义标签名。

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202402889-f45d3275-645e-4633-898a-d60b8c025f19.png" width="40%" height="20%">
   </p>

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202403435-5c30bf95-1389-4e63-8a49-cb08524050e6.png" width="40%" height="20%">
   </p>

3. **图像加载**

   打开图像/图像文件夹。当看到主界面图像正确加载，`数据列表`正确出现图像路径即可。

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202403076-4d67bbc8-b9d8-401f-811d-cf5c7f8f8a1c.png" width="40%" height="20%">
   </p>

4. **标签添加/加载**

   添加/加载标签。如果用户启用了预标注功能，则会在标签列表中自动添加模型预测的标签，用户也可以通过手动点击`添加标签`按钮来新建标签，标签分为4列，分别对应像素值、说明、颜色和删除。新建好的标签可以通过`保存标签列表`保存为txt文件，其他合作者可以通过`加载标签列表`将标签导入。通过加载方式导入的标签，重启软件后会自动加载。此外，还支持标签的查找，可以通过`查找`来搜索标签列表里面是否存在特定标签，便于用户快速定位目标标签。

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202403524-6a008e5f-9f00-418c-b91e-0602ae71fb49.png" width="40%" height="20%">
   </p>

5. **开始标注**

   如果用户启用了预标注功能，则可以对模型预测的检测框进行修改和删除，用户也可以在`检测设置`区域中点击`开启画框功能`按钮，以及选中`标签列表`区域的特定标签在当前展示的图像中进行手动画框，可以拖动框的左上角和右下角来对框进行修改。可以通过鼠标左键点击选中指定框进行删除，也可以在画框的时候选择设置十字丝的颜色。此外，检测框的颜色和标签的颜色是一一对应的。

   <p align="center">
   <img src="https://user-images.githubusercontent.com/48357642/202403616-8a57bf25-7eee-4814-be57-0d7889042ebb.png" width="40%" height="20%">
   </p>

6. **自动保存设置**

   在使用中可以将`自动保存`设置上，设定好文件夹即可，这样在使用时切换图像会自动将完成标注的图像进行保存。

## 特色功能使用说明

- **检测设置**

    - 在启用预标注功能后，用户可以在`检测设置`区域中拖动`分数域值`滑块，来设置模型预测的置信度，进而显示出不同数量的检测框，其中手动编辑过的框不会随着滑块的滑动而消失。
    - 在启用预标注功能后，用户可以在`检测设置`区域中点击`重推理`按钮，会删除原来所有的检测框并进行重新推理和显示。

- **保存格式**

    - 检测标注的标签默认情况下保存为COCO格式，用户也可以根据自己的需要选择保存为VOC、YOLO格式。
    - 若不设置保存路径，默认保存至当前图像文件夹下的label文件夹中。
